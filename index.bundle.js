(()=>{"use strict";var t,i={947:(t,i,n)=>{n.d(i,{Z:()=>r});var e=n(537),o=n.n(e),a=n(645),s=n.n(a)()(o());s.push([t.id,".game-canvas {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n}","",{version:3,sources:["webpack://./src/App.module.css"],names:[],mappings:"AAAA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,MAAM;EACN,OAAO;AACT",sourcesContent:[".game-canvas {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n}"],sourceRoot:""}]),s.locals={"game-canvas":"game-canvas"};const r=s},488:(t,i,n)=>{n.d(i,{Z:()=>r});var e=n(537),o=n.n(e),a=n(645),s=n.n(a)()(o());s.push([t.id,".ui-controller {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n}","",{version:3,sources:["webpack://./src/react-ui/UIController.module.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,MAAM;EACN,OAAO;AACT",sourcesContent:[".ui-controller {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n}"],sourceRoot:""}]),s.locals={"ui-controller":"ui-controller"};const r=s},460:(t,i,n)=>{n.d(i,{Z:()=>r});var e=n(537),o=n.n(e),a=n(645),s=n.n(a)()(o());s.push([t.id,".dialog {\n  position: absolute;\n  top: 45%;\n  left: 50%;\n  transform: translateX(-25%);\n  z-index: 5;\n  background-color: rgba(0, 0, 0, 0.5);\n  align-items: center;\n  color: white;\n  display: flex;\n  flex-direction: row;\n}\n\n@keyframes text {\n  from {\n    width: 0%;\n  }\n  to {\n    width: 100%;\n  }\n}\n\n@keyframes fadeIn {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n.dialog-key {\n  width: 50px;\n  height: 50px;\n  text-align: center;\n  font-weight: bold;\n  font-size: 40px;\n  border: 3px gold solid;\n}\n\n.dialog-content {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  padding: 10px;\n  font-size: 25px;\n  font-family: pixel-font, sans-serif;\n}\n\n.dialog-animation-text {\n  animation-name: text;\n  animation-duration: 1s;\n  animation-timing-function: linear;\n}\n\n.dialog-animation-fade {\n  animation-name: fadeIn;\n  animation-duration: 200ms;\n  animation-timing-function: linear;\n}\n","",{version:3,sources:["webpack://./src/react-ui/components/Dialog.module.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,QAAQ;EACR,SAAS;EACT,2BAA2B;EAC3B,UAAU;EACV,oCAAoC;EACpC,mBAAmB;EACnB,YAAY;EACZ,aAAa;EACb,mBAAmB;AACrB;;AAEA;EACE;IACE,SAAS;EACX;EACA;IACE,WAAW;EACb;AACF;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,iBAAiB;EACjB,eAAe;EACf,sBAAsB;AACxB;;AAEA;EACE,gBAAgB;EAChB,uBAAuB;EACvB,mBAAmB;EACnB,aAAa;EACb,eAAe;EACf,mCAAmC;AACrC;;AAEA;EACE,oBAAoB;EACpB,sBAAsB;EACtB,iCAAiC;AACnC;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;EACzB,iCAAiC;AACnC",sourcesContent:[".dialog {\n  position: absolute;\n  top: 45%;\n  left: 50%;\n  transform: translateX(-25%);\n  z-index: 5;\n  background-color: rgba(0, 0, 0, 0.5);\n  align-items: center;\n  color: white;\n  display: flex;\n  flex-direction: row;\n}\n\n@keyframes text {\n  from {\n    width: 0%;\n  }\n  to {\n    width: 100%;\n  }\n}\n\n@keyframes fadeIn {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n.dialog-key {\n  width: 50px;\n  height: 50px;\n  text-align: center;\n  font-weight: bold;\n  font-size: 40px;\n  border: 3px gold solid;\n}\n\n.dialog-content {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  padding: 10px;\n  font-size: 25px;\n  font-family: pixel-font, sans-serif;\n}\n\n.dialog-animation-text {\n  animation-name: text;\n  animation-duration: 1s;\n  animation-timing-function: linear;\n}\n\n.dialog-animation-fade {\n  animation-name: fadeIn;\n  animation-duration: 200ms;\n  animation-timing-function: linear;\n}\n"],sourceRoot:""}]),s.locals={dialog:"dialog","dialog-key":"dialog-key","dialog-content":"dialog-content","dialog-animation-text":"dialog-animation-text",text:"text","dialog-animation-fade":"dialog-animation-fade",fadeIn:"fadeIn"};const r=s},354:(t,i,n)=>{var e=n(784),o=n(29),a=n(379),s=n.n(a),r=n(795),h=n.n(r),l=n(569),c=n.n(l),d=n(565),p=n.n(d),u=n(216),f=n.n(u),m=n(589),y=n.n(m),A=n(947),g={};g.styleTagTransform=y(),g.setAttributes=p(),g.insert=c().bind(null,"head"),g.domAPI=h(),g.insertStyleElement=f(),s()(A.Z,g),A.Z&&A.Z.locals&&A.Z.locals;var w=n(940),x=n(277);function v({frameSize:t,animationNames:i,assetPath:n,idleAnimationName:e,animationSettings:o,scale:a="1"}){return s=this,r=void 0,l=function*(){const s=i.map(((i,n)=>function(t,i,n){const e={};for(let o=0;o<4;o++)e[`${t}${o}`]={frame:{x:o*n.width,y:i*n.height,w:n.width,h:n.height},sourceSize:{w:n.width,h:n.height}};return e}(i,n,t))),r={frames:Object.assign({},...s),meta:{scale:a},animations:s.reduce(((t,n,e)=>(t[i[e]]=Object.keys(n),t)),{})},h=new w.c2G(w.VL4.from(n),r);yield h.parse();const l=new w.W20;return l.switchAnimation=t=>{l.children.length>0&&l.removeChildAt(0);const i=new w.KgH(h.animations[t]);l.addChild(i),o&&(Object.assign(i,o["*"],o[t]),(null==i?void 0:i.autoPlay)&&i.play())},l.spriteSheet=h,l.play=()=>{var t;return null===(t=l.children[0])||void 0===t?void 0:t.play()},l.switchAnimation(e),l},new((h=void 0)||(h=Promise))((function(t,i){function n(t){try{o(l.next(t))}catch(t){i(t)}}function e(t){try{o(l.throw(t))}catch(t){i(t)}}function o(i){var o;i.done?t(i.value):(o=i.value,o instanceof h?o:new h((function(t){t(o)}))).then(n,e)}o((l=l.apply(s,r||[])).next())}));var s,r,h,l}const k=100;var E;!function(t){t[t.floor=0]="floor",t[t.wall=1]="wall",t[t.door=2]="door"}(E||(E={}));class b extends w.W20{constructor(t,i){super(),this.map=t,this.app=i,this.kind="character",this.zIndex=1,this.speed=5}init(){return t=this,i=void 0,e=function*(){this.animation=yield v({frameSize:{width:100,height:120},assetPath:"assets/character-sprite.png",animationNames:["walk-down","walk-up","walk-left","walk-right","idle"],idleAnimationName:"idle",animationSettings:{"*":{animationSpeed:.1666,loop:!0,autoPlay:!0},idle:{autoPlay:!0,animationSpeed:.0666}},scale:"1.4"}),this.addChild(this.animation),this.animation.x=(k-this.width)/2,this.stopWalking(),this.app.ticker.add(this.onTick.bind(this))},new((n=void 0)||(n=Promise))((function(o,a){function s(t){try{h(e.next(t))}catch(t){a(t)}}function r(t){try{h(e.throw(t))}catch(t){a(t)}}function h(t){var i;t.done?o(t.value):(i=t.value,i instanceof n?i:new n((function(t){t(i)}))).then(s,r)}h((e=e.apply(t,i||[])).next())}));var t,i,n,e}destroy(){super.destroy(),this.app.ticker.remove(this.onTick.bind(this))}onTick(t){if(this.walkDirection)switch(this.walkDirection){case"up":this.move(0,this.speed*t);break;case"down":this.move(0,-this.speed*t);break;case"left":this.move(this.speed*t,0);break;case"right":this.move(-this.speed*t,0)}}move(t,i){const n={x:this.x+-1*t,y:this.y+-1*i};this.collidesWithWall(n,t,i)?this.stopWalking():(this.x=n.x,this.y=n.y,this.zIndex=Math.round(n.y/k),this.map.container.y+=i,this.map.container.x+=t)}collidesWithWall(t,i,n){const e=Math.floor(this.x/k)!==Math.floor((this.x+this.width)/k),o=Math.floor(this.y/k)!==Math.floor((this.y+this.height)/k),a=[];return n<0?(a.push({x:Math.floor((t.x+20)/k),y:Math.floor((t.y+this.height)/k)}),e&&a.push({x:Math.floor((t.x+this.width)/k),y:Math.floor((t.y+this.height)/k)})):n>0?(a.push({x:Math.floor((t.x+20)/k),y:Math.ceil((t.y-this.height/2)/k)}),e&&a.push({x:Math.floor((t.x+this.width)/k),y:Math.ceil((t.y-this.height/2)/k)})):i>0?(a.push({x:Math.floor((t.x+20)/k),y:Math.ceil((t.y-this.height/2)/k)}),o&&a.push({x:Math.floor((t.x+20)/k),y:Math.ceil((t.y-this.height/2)/k)})):i<0&&(a.push({x:Math.floor((t.x+this.width)/k),y:Math.ceil((t.y-this.height/2)/k)}),o&&a.push({x:Math.floor((t.x+this.width)/k),y:Math.ceil((t.y-this.height/2)/k)})),a.some((i=>{const n=this.map.cells.find((t=>t.x===i.x&&t.y===i.y&&t.solid));return n&&n.kind===E.wall&&(n.properties.wallType.includes("vertical")||n.properties.wallType.includes("right-corner"))&&"vertical-T"!==n.properties.wallType?t.x<n.x*k+10:null==n?void 0:n.solid}))}walk(t){this.walkDirection!==t&&(this.stopWalking(),this.walkDirection=t,this.animation.switchAnimation(`walk-${t}`))}stopWalking(){this.walkDirection=void 0,this.animation.switchAnimation("idle")}}function C(t,i){return Math.floor(Math.random()*(i-t+1))+t}var M;function B(t,i,n){const e={top:void 0,bottom:void 0,left:void 0,right:void 0,self:void 0};return n.forEach((n=>{n.kind!==E.wall&&n.kind!==E.door||(n.x===t&&n.y===i&&(e.self=n),n.x===t-1&&n.y===i&&(e.left=n),n.x===t+1&&n.y===i&&(e.right=n),n.x===t&&n.y===i-1&&(e.top=n),n.x===t&&n.y===i+1&&(e.bottom=n))})),e}function T({x:t,y:i},n){var e,o,a,s,r;const h=B(t,i,n),l=null===(o=null===(e=h.top)||void 0===e?void 0:e.properties)||void 0===o?void 0:o.wallType,c=null===(s=null===(a=h.self)||void 0===a?void 0:a.properties)||void 0===s?void 0:s.wallType;return(null===(r=h.self)||void 0===r?void 0:r.kind)===E.door||(null==c?void 0:c.includes("window"))?"floor":h.self?!(null==l?void 0:l.includes("horizontal"))&&"vertical-T"!==l||"horizontal-right-corner-bottom"===l?"floor-shadow-left":"floor-shadow-corner":h.top&&((null==l?void 0:l.includes("horizontal"))||h.top.kind===E.door)?"horizontal-right-corner-top"===l?"floor-shadow-top-left":"floor-shadow-top":"floor"}function S({x:t,y:i},n){var e;const o=B(t,i,n);if(o.left&&o.right){if(o.bottom)return"horizontal-T";if("horizontal-window-left"===(null===(e=o.left.properties)||void 0===e?void 0:e.wallType))return"horizontal-window-right";const t=!!n.find((t=>o.right.x+1===t.x&&o.right.y===t.y&&t.kind===E.wall));return o.right.kind===E.wall&&t&&0===C(0,3)?"horizontal-window-left":"horizontal"}return o.top&&o.bottom?o.right?"vertical-T":"vertical":o.left?o.bottom?"horizontal-right-corner-bottom":o.top?"horizontal-right-corner-top":"horizontal-right":o.right?o.bottom?"horizontal-left-corner-bottom":o.top?"horizontal-left-corner-top":"horizontal-left":o.top?"vertical-bottom":o.bottom?"vertical-top":"pillar"}!function(t){t[t.North=0]="North",t[t.East=1]="East",t[t.South=2]="South",t[t.West=3]="West"}(M||(M={}));function W(t,i){switch(i){case M.North:return t.reduce(((t,i)=>i.y<t.y?i:t));case M.East:return t.reduce(((t,i)=>i.x>t.x?i:t));case M.South:return t.reduce(((t,i)=>i.y>t.y?i:t));case M.West:return t.reduce(((t,i)=>i.x<t.x?i:t))}}function z(t,i){return C(Math.max(t.x+1,i.x+1),Math.min(t.x+t.width-2,i.x+i.width-2))}function P(t,i){return C(Math.max(t.y+1,i.y+1),Math.min(t.y+t.height-2,i.y+i.height-2))}class I{constructor(){this.container=new w.W20,this.entities=[];const{map:t,startCoords:i}=function(){const t=Array.from({length:20}).map((()=>({x:0,y:0,width:C(5,10),height:C(5,10)})));t.slice(1).forEach(((i,n)=>{const e=C(0,3);!function(t,i,n){const e=C(1,2),o=Math.min(t.width,n.width),a=Math.min(t.height,n.height);let s,r;const h=1===C(0,1)?1:-1;switch(i){case M.North:t.y=n.y-t.height-e,t.x=n.x+C(0,o-3)*h,s=z(t,n),t.corridor={from:{x:s,y:t.y+t.height-1},to:{x:s,y:n.y},direction:i};break;case M.East:t.x=n.x+n.width+e,t.y=n.y+C(0,a-3)*h,r=P(t,n),t.corridor={from:{x:t.x,y:r},to:{x:n.x+n.width-1,y:r},direction:i};break;case M.South:t.y=n.y+n.height+e,t.x=n.x+C(0,o-3)*h,s=z(t,n),t.corridor={from:{x:s,y:t.y},to:{x:s,y:n.y+n.height-1},direction:i};break;case M.West:t.x=n.x-t.width-e,t.y=n.y+C(0,a-3)*h,r=P(t,n),t.corridor={from:{x:t.x+t.width-1,y:r},to:{x:n.x,y:r},direction:i}}}(i,e,0===n?t[0]:W(t,e))}));const i=W(t,M.West),n=W(t,M.North),e=i.x,o=n.y,a=[];return t.forEach((t=>{for(let i=0;i<t.height;i++)for(let n=0;n<t.width;n++){const s=0===n||n===t.width-1||0===i||i===t.height-1,r=Math.abs(e-(t.x+n)),h=Math.abs(o-(t.y+i));void 0===a[h]&&(a[h]=[]),a[h][r]=s?1:0}})),t.filter((t=>!!t.corridor)).forEach((t=>{const{from:i,to:n,direction:s}=t.corridor,r=s===M.North||s===M.South?Math.abs(i.y-n.y):Math.abs(i.x-n.x);for(let t=0;t<=r;t++){let n=Math.abs(e-i.x),r=Math.abs(o-i.y);s===M.North?r+=t:s===M.East?n-=t:s===M.South?r-=t:s===M.West&&(n+=t),void 0===a[r]&&(a[r]=[]),a[r][n]=0,s===M.North||s===M.South?(a[r][n-1]=1,a[r][n+1]=1):s!==M.East&&s!==M.West||(void 0===a[r-1]&&(a[r-1]=[]),void 0===a[r+1]&&(a[r+1]=[]),a[r-1][n]=1,a[r+1][n]=1)}if(s===M.North||s===M.South){const t=Math.abs(e-n.x),i=Math.abs(o-n.y);a[i][t]=2}})),{map:a,startCoords:{x:Math.abs(e-(t[0].x+Math.floor(t[0].width/2))),y:Math.abs(o-(t[0].y+Math.floor(t[0].height/2)))}}}();this.rawMap=t,this.startLocation=i}init(){return t=this,i=void 0,e=function*(){this.cells=yield function(t){return i=this,n=void 0,o=function*(){const i=t.reduce(((i,n,e)=>(n.forEach(((n,o)=>{var a;const s=n;i.push({kind:s,x:o,y:e,solid:s===E.wall||s===E.door}),s!==E.wall&&s!==E.door||void 0===t[e][o+1]||void 0===(null===(a=t[e-1])||void 0===a?void 0:a[o])||i.push({kind:E.floor,x:o,y:e,solid:!1})})),i)),[]);for(let t=0;t<i.length;t++){const n=i[t];switch(n.kind){case E.wall:n.properties={wallType:S(n,i)},n.asset=w.jyi.from(`assets/walls/${n.properties.wallType}.png`),n.asset.zIndex=n.y,n.asset.anchor.y=n.asset.height/2;break;case E.floor:n.properties={floorType:T(n,i)},n.asset=w.jyi.from(`assets/floors/${n.properties.floorType}.png`),n.asset.zIndex=-1;break;case E.door:n.asset=yield v({frameSize:{width:100,height:200},assetPath:"assets/door.png",animationNames:["open","close"],idleAnimationName:"open",animationSettings:{"*":{animationSpeed:.1666,loop:!1}}}),n.properties={open:!1,toggle:()=>{const t=n;t.properties.open?t.properties.open&&(t.properties.open=!1,t.solid=!0,t.asset.switchAnimation("close"),t.asset.play()):(t.properties.open=!0,t.solid=!1,t.asset.switchAnimation("open"),t.asset.play())}},n.asset.zIndex=n.y,n.asset.pivot.y=n.asset.height/2}n.asset.x=n.x*k,n.asset.y=n.y*k}return i},new((e=void 0)||(e=Promise))((function(t,a){function s(t){try{h(o.next(t))}catch(t){a(t)}}function r(t){try{h(o.throw(t))}catch(t){a(t)}}function h(i){var n;i.done?t(i.value):(n=i.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,r)}h((o=o.apply(i,n||[])).next())}));var i,n,e,o}(this.rawMap),this.cells.forEach((t=>this.container.addChild(t.asset))),this.container.sortableChildren=!0},new((n=void 0)||(n=Promise))((function(o,a){function s(t){try{h(e.next(t))}catch(t){a(t)}}function r(t){try{h(e.throw(t))}catch(t){a(t)}}function h(t){var i;t.done?o(t.value):(i=t.value,i instanceof n?i:new n((function(t){t(i)}))).then(s,r)}h((e=e.apply(t,i||[])).next())}));var t,i,n,e}destroy(){this.container.destroy(),this.entities.forEach((t=>t.destroy()))}addEntity(t){this.entities.push(t),this.container.addChild(t)}getEntities(){return this.entities}getCell(t,i){const n=Math.round(t/k),e=Math.round(i/k);return this.cells.find((t=>t.x===n&&t.y===e))}getCells(t,i,n){return this.cells.filter((e=>e.x>=Math.round((t-n)/k)&&e.x<=Math.round((t+n)/k)&&e.y>=Math.round((i-n)/k)&&e.y<=Math.round((i+n)/k)))}}const N=new class{constructor(){this.eventCounter=0}listen(t){this.listener=t}showDialog(t,i){var n;const e=(this.eventCounter++).toString();null===(n=this.listener)||void 0===n||n.call(this,"new",{id:e,type:"dialog",content:t,options:i});const o=()=>this.closeDialog(e);return(null==i?void 0:i.dismissTimeout)&&setTimeout(o,i.dismissTimeout),o}closeDialog(t){var i;null===(i=this.listener)||void 0===i||i.call(this,"delete",{id:t})}};class O{constructor(t,i,n){this.character=t,this.map=i,this.app=n,this.pressedKeys=new Set,this.checkForInteractions=()=>{var t,i;const{x:n,y:e}=this.character,o=this.map.getCells(n,e,40).some((t=>t.kind===E.door));o&&!this.dialogDismiss?(null===(t=this.dialogDismiss)||void 0===t||t.call(this),this.dialogDismiss=N.showDialog({key:"E",message:"Interact"},{animation:"fade"})):o||(null===(i=this.dialogDismiss)||void 0===i||i.call(this),this.dialogDismiss=void 0)},window.addEventListener("keydown",this.onKeyDown.bind(this)),window.addEventListener("keyup",this.onKeyUp.bind(this)),this.app.ticker.add(this.onTick.bind(this))}destroy(){this.app.ticker.remove(this.onTick.bind(this))}onTick(){this.checkForInteractions()}checkKeysPressed(){switch(this.pressedKeys.values().next().value){case"e":this.interact();break;case"ArrowUp":this.character.walk("up");break;case"ArrowDown":this.character.walk("down");break;case"ArrowLeft":this.character.walk("left");break;case"ArrowRight":this.character.walk("right");break;default:this.character.stopWalking()}}interact(){const{x:t,y:i}=this.character,n=this.map.getCells(t,i,40).find((t=>t.kind===E.door));!n||n.x===Math.round(t/k)&&n.y===Math.round((i+20)/k)||n.properties.toggle()}onKeyDown(t){(t.key.includes("Arrow")||"e"===t.key)&&(this.pressedKeys.add(t.key),this.checkKeysPressed())}onKeyUp(t){this.pressedKeys.delete(t.key),this.checkKeysPressed()}}function D(t,i,n,e){return Math.sqrt(Math.pow(n-t,2)+Math.pow(e-i,2))}function Z(t,i,n,e){const o=n.getCell(i.x-1,i.y-1),a=[];n.cells.forEach((t=>{a[t.y]||(a[t.y]=[]),void 0===a[t.y][t.x]&&(a[t.y][t.x]=t.solid?-1:0)})),a[t.y][t.x]=2;const s=function t(i,n){const a=i.pop();if(!a||n[a.y][a.x]>e)return!1;const{x:s,y:r}=a,h=n[r][s];if(o.x===s&&o.y===r)return!0;const l=h+1;return l>e||(r-1>=0&&0===n[r-1][s]&&(n[r-1][s]=l,i.push({y:r-1,x:s})),r+1<n.length&&0===n[r+1][s]&&(n[r+1][s]=l,i.push({y:r+1,x:s})),s-1>=0&&0===n[r][s-1]&&(n[r][s-1]=l,i.push({y:r,x:s-1})),s+1<n[r].length&&0===n[r][s+1]&&(n[r][s+1]=l,i.push({y:r,x:s+1}))),t(i,n)}([t],a);if(!s)return[];const r=[];let h=o.x,l=o.y;for(;;)if(r.unshift({x:h,y:l}),h-1>=0&&a[l][h-1]===a[l][h]-1)h--;else if(h+1<a[l].length&&a[l][h+1]===a[l][h]-1)h++;else if(l-1>=0&&a[l-1][h]===a[l][h]-1)l--;else{if(!(l+1<a.length&&a[l+1][h]===a[l][h]-1))break;l++}return r}class j extends w.W20{constructor(t,i,n,e=200,o=50){super(),this.map=t,this.app=i,this.speed=n,this.detectionRange=e,this.hitRange=o,this.kind="enemy",this.app.ticker.add(this.onTick.bind(this))}init(){return t=this,i=void 0,e=function*(){this.animation=yield v({frameSize:{width:100,height:100},assetPath:"assets/enemy-sprite.png",animationNames:["walk-down","walk-up","walk-left","walk-right","idle"],idleAnimationName:"idle",animationSettings:{"*":{animationSpeed:.1666,loop:!0,autoPlay:!0},idle:{autoPlay:!0,animationSpeed:.0666}},scale:"1"}),this.addChild(this.animation),this.animation.x=(k-this.width)/2,this.stopWalking()},new((n=void 0)||(n=Promise))((function(o,a){function s(t){try{h(e.next(t))}catch(t){a(t)}}function r(t){try{h(e.throw(t))}catch(t){a(t)}}function h(t){var i;t.done?o(t.value):(i=t.value,i instanceof n?i:new n((function(t){t(i)}))).then(s,r)}h((e=e.apply(t,i||[])).next())}));var t,i,n,e}destroy(){super.destroy(),this.app.ticker.remove(this.onTick.bind(this))}onTick(){var t;(null===(t=this.path)||void 0===t?void 0:t.length)>0&&this.walkOnPath();for(const t of this.map.getEntities()){const i=D(this.x,this.y,t.x,t.y);if("character"===t.kind&&i<this.hitRange);else if("character"===t.kind&&i<this.detectionRange&&i>this.hitRange&&(!this.path||0===this.path.length||this.path[this.path.length-1].x!==Math.round(t.x/k)&&this.path[this.path.length-1].y!==Math.round(t.y/k))){const n=this.map.getCell(this.x-1,this.y-1);return void(this.path=Z(n,t,this.map,i/k+4))}}}walkOnPath(){const t=this.path[0],i=t.x*k,n=t.y*k,e=i-this.x,o=n-this.y,a=D(this.x,this.y,i,n);Math.abs(e)>Math.abs(o)?e>0?this.walk("right"):this.walk("left"):o>0?this.walk("down"):this.walk("up"),a<this.hitRange?(this.x=i,this.y=n,this.path.shift(),this.stopWalking()):(this.x+=e/a*this.speed,this.y+=o/a*this.speed)}walk(t){this.walkDirection!==t&&(this.stopWalking(),this.walkDirection=t,this.animation.switchAnimation(`walk-${t}`))}stopWalking(){this.walkDirection=void 0,this.animation.switchAnimation("idle")}}const K=new w.MxU({width:window.innerWidth,height:window.innerHeight,resizeTo:window,backgroundColor:"#000000"});class U{constructor(){this.map=new I,K.stage.filterArea=K.screen;const t=new x.X({vignetting:1});K.stage.filters=[t];const i=setInterval((()=>{t.vignetting-=.01,t.vignetting<.67&&(clearInterval(i),N.showDialog({message:"Uh.. Where am I?"},{dismissTimeout:2e3,animation:"text"}))}),50)}init(){return t=this,i=void 0,e=function*(){yield this.map.init(),this.character=new b(this.map,K),yield this.character.init(),this.character.x=this.map.startLocation.x*k,this.character.y=this.map.startLocation.y*k,this.map.addEntity(this.character);const t=new j(this.map,K,2,300);yield t.init(),t.x=this.map.startLocation.x*k,t.y=this.map.startLocation.y*k,this.map.addEntity(t);const i=K.view.width/2,n=K.view.height/2;this.map.container.x=i-this.character.x,this.map.container.y=n-this.character.y,K.stage.addChild(this.map.container),this.interactionManager=new O(this.character,this.map,K)},new((n=void 0)||(n=Promise))((function(o,a){function s(t){try{h(e.next(t))}catch(t){a(t)}}function r(t){try{h(e.throw(t))}catch(t){a(t)}}function h(t){var i;t.done?o(t.value):(i=t.value,i instanceof n?i:new n((function(t){t(i)}))).then(s,r)}h((e=e.apply(t,i||[])).next())}));var t,i,n,e}destroy(){this.interactionManager.destroy(),this.map.destroy()}}var R=n(488),L={};L.styleTagTransform=y(),L.setAttributes=p(),L.insert=c().bind(null,"head"),L.domAPI=h(),L.insertStyleElement=f(),s()(R.Z,L),R.Z&&R.Z.locals&&R.Z.locals;var Y=n(460),X={};X.styleTagTransform=y(),X.setAttributes=p(),X.insert=c().bind(null,"head"),X.domAPI=h(),X.insertStyleElement=f(),s()(Y.Z,X),Y.Z&&Y.Z.locals&&Y.Z.locals;const $={dialog:function({content:t,options:i}){return e.createElement("div",{className:"dialog "+("fade"===(null==i?void 0:i.animation)?"dialog-animation-fade":"")},t.key&&e.createElement("kbd",{className:"dialog-key"},t.key),e.createElement("div",{className:"dialog-content "+("text"===(null==i?void 0:i.animation)?"dialog-animation-text":"")},t.message))}};function _(){const[t,i]=e.useState([]);return e.useEffect((()=>{N.listen(((t,n)=>{switch(t){case"new":i((t=>[...t,n]));break;case"delete":i((t=>t.filter((t=>t.id!==n.id))))}}))}),[N]),e.createElement("div",{className:"ui-controller"},t.map((t=>{const i=$[t.type];return e.createElement(i,Object.assign({key:t.id},t))})))}(0,o.s)(document.getElementById("root")).render(e.createElement((function(){return e.useEffect((()=>{const t=document.createElement("div");t.className="game-canvas",t.appendChild(K.view),document.body.appendChild(t);const i=new U;return i.init(),i.destroy}),[]),e.createElement(_,null)}),null))}},n={};function e(t){var o=n[t];if(void 0!==o)return o.exports;var a=n[t]={id:t,loaded:!1,exports:{}};return i[t].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}e.m=i,t=[],e.O=(i,n,o,a)=>{if(!n){var s=1/0;for(c=0;c<t.length;c++){for(var[n,o,a]=t[c],r=!0,h=0;h<n.length;h++)(!1&a||s>=a)&&Object.keys(e.O).every((t=>e.O[t](n[h])))?n.splice(h--,1):(r=!1,a<s&&(s=a));if(r){t.splice(c--,1);var l=o();void 0!==l&&(i=l)}}return i}a=a||0;for(var c=t.length;c>0&&t[c-1][2]>a;c--)t[c]=t[c-1];t[c]=[n,o,a]},e.n=t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},e.d=(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={826:0};e.O.j=i=>0===t[i];var i=(i,n)=>{var o,a,[s,r,h]=n,l=0;if(s.some((i=>0!==t[i]))){for(o in r)e.o(r,o)&&(e.m[o]=r[o]);if(h)var c=h(e)}for(i&&i(n);l<s.length;l++)a=s[l],e.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return e.O(c)},n=self.webpackChunkweb_app=self.webpackChunkweb_app||[];n.forEach(i.bind(null,0)),n.push=i.bind(null,n.push.bind(n))})(),e.nc=void 0;var o=e.O(void 0,[814],(()=>e(354)));o=e.O(o)})();
//# sourceMappingURL=index.bundle.js.map